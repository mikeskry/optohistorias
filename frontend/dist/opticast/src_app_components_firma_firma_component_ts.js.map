{"version":3,"file":"src_app_components_firma_firma_component_ts.js","mappings":"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","sources":["./src/app/components/firma/firma.component.ts","./src/app/components/firma/firma.component.html","./src/app/services/firma.service.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { FormsModule } from '@angular/forms';\nimport { FirmaService } from '../../services/firma.service';\nimport { AuthService } from '../../services/auth.service';\nimport { ToastService } from '../../services/toast.service';\nimport { User } from '../../models/user.model';\n\n@Component({\n  selector: 'app-firma',\n  standalone: true,\n  imports: [CommonModule, FormsModule],\n  templateUrl: './firma.component.html',\n  styleUrls: ['./firma.component.css']\n})\nexport class FirmaComponent implements OnInit {\n  currentUser: User | null = null;\n  selectedFile: File | null = null;\n  filePreview: string | null = null;\n  isUploading = false;\n  isDeleting = false;\n\n  constructor(\n    private firmaService: FirmaService,\n    private authService: AuthService,\n    private toastService: ToastService\n  ) {}\n\n  ngOnInit() {\n    this.authService.currentUser$.subscribe(user => {\n      this.currentUser = user;\n    });\n  }\n\n  onFileSelected(event: any) {\n    const file = event.target.files[0];\n    if (file) {\n      // Validar tipo de archivo\n      const allowedTypes = ['image/jpeg', 'image/png', 'image/gif'];\n      if (!allowedTypes.includes(file.type)) {\n        this.toastService.showError('Solo se permiten archivos JPG, PNG y GIF');\n        return;\n      }\n      \n      // Validar tamaño (2MB máximo)\n      if (file.size > 2 * 1024 * 1024) {\n        this.toastService.showError('El archivo es demasiado grande. Tamaño máximo: 2MB');\n        return;\n      }\n      \n      this.selectedFile = file;\n      \n      // Crear preview\n      const reader = new FileReader();\n      reader.onload = (e: any) => {\n        this.filePreview = e.target.result;\n      };\n      reader.readAsDataURL(file);\n    }\n  }\n\n  removeSelectedFile() {\n    this.selectedFile = null;\n    this.filePreview = null;\n    // Limpiar el input file\n    const fileInput = document.getElementById('firmaFile') as HTMLInputElement;\n    if (fileInput) {\n      fileInput.value = '';\n    }\n  }\n\n  uploadFirma() {\n    if (!this.selectedFile) {\n      this.toastService.showError('Por favor seleccione un archivo');\n      return;\n    }\n\n    this.isUploading = true;\n\n    this.firmaService.uploadFirma(this.selectedFile).subscribe({\n      next: (response) => {\n        this.toastService.showSuccess('Firma actualizada exitosamente');\n        \n        // Actualizar el usuario actual con la nueva firma\n        if (this.currentUser) {\n          this.currentUser.firma = response.data.firma;\n          this.authService.updateCurrentUser(this.currentUser);\n        }\n        \n        this.removeSelectedFile();\n        this.isUploading = false;\n      },\n      error: (error) => {\n        console.error('FirmaComponent::uploadFirma - Error:', error);\n        this.toastService.showError('Error al subir la firma: ' + (error.error?.message || 'Error desconocido'));\n        this.isUploading = false;\n      }\n    });\n  }\n\n  deleteFirma() {\n    if (!this.currentUser?.firma) {\n      this.toastService.showError('No hay firma para eliminar');\n      return;\n    }\n\n    if (!confirm('¿Está seguro que desea eliminar la firma actual?')) {\n      return;\n    }\n\n    this.isDeleting = true;\n\n    this.firmaService.deleteFirma().subscribe({\n      next: (response) => {\n        this.toastService.showSuccess('Firma eliminada exitosamente');\n        \n        // Actualizar el usuario actual removiendo la firma\n        if (this.currentUser) {\n          this.currentUser.firma = undefined;\n          this.authService.updateCurrentUser(this.currentUser);\n        }\n        \n        this.isDeleting = false;\n      },\n      error: (error) => {\n        console.error('FirmaComponent::deleteFirma - Error:', error);\n        this.toastService.showError('Error al eliminar la firma: ' + (error.error?.message || 'Error desconocido'));\n        this.isDeleting = false;\n      }\n    });\n  }\n\n  getFirmaUrl(): string {\n    if (!this.currentUser?.firma) return '';\n    return this.firmaService.getFirmaUrl(this.currentUser.firma);\n  }\n}","<div class=\"container mt-4\">\r\n  <div class=\"row justify-content-center\">\r\n    <div class=\"col-md-8\">\r\n      <div class=\"card\">\r\n        <div class=\"card-header\">\r\n          <h4 class=\"mb-0\">\r\n            <i class=\"fas fa-signature me-2\"></i>\r\n            Gestión de Firma\r\n          </h4>\r\n        </div>\r\n        <div class=\"card-body\">\r\n          \r\n          <!-- Firma actual -->\r\n          <div class=\"mb-4\" *ngIf=\"currentUser?.firma\">\r\n            <h5>Firma Actual</h5>\r\n            <div class=\"firma-preview\">\r\n              <img [src]=\"getFirmaUrl()\" \r\n                   alt=\"Firma actual\" \r\n                   class=\"img-fluid border rounded\">\r\n            </div>\r\n            <div class=\"mt-2\">\r\n              <button class=\"btn btn-danger btn-sm\" \r\n                      (click)=\"deleteFirma()\" \r\n                      [disabled]=\"isDeleting\">\r\n                <i class=\"fas fa-trash me-1\" *ngIf=\"!isDeleting\"></i>\r\n                <i class=\"fas fa-spinner fa-spin me-1\" *ngIf=\"isDeleting\"></i>\r\n                {{ isDeleting ? 'Eliminando...' : 'Eliminar Firma' }}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- No hay firma -->\r\n          <div class=\"mb-4\" *ngIf=\"!currentUser?.firma\">\r\n            <div class=\"alert alert-info\">\r\n              <i class=\"fas fa-info-circle me-2\"></i>\r\n              No hay firma configurada. Suba una imagen de su firma para usarla en los documentos.\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Subir nueva firma -->\r\n          <div class=\"mb-4\">\r\n            <h5>{{ currentUser?.firma ? 'Actualizar Firma' : 'Subir Firma' }}</h5>\r\n            \r\n            <div class=\"mb-3\">\r\n              <label for=\"firmaFile\" class=\"form-label\">Seleccionar Archivo de Firma</label>\r\n              <input type=\"file\" \r\n                     id=\"firmaFile\"\r\n                     class=\"form-control\" \r\n                     accept=\"image/*\"\r\n                     (change)=\"onFileSelected($event)\">\r\n              <div class=\"form-text\">\r\n                Formatos permitidos: JPG, PNG, GIF. Tamaño máximo: 2MB\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Preview del archivo seleccionado -->\r\n            <div class=\"mb-3\" *ngIf=\"filePreview\">\r\n              <label class=\"form-label\">Vista Previa</label>\r\n              <div class=\"firma-preview\">\r\n                <img [src]=\"filePreview\" \r\n                     alt=\"Vista previa\" \r\n                     class=\"img-fluid border rounded\">\r\n              </div>\r\n              <div class=\"mt-2\">\r\n                <button class=\"btn btn-outline-secondary btn-sm\" \r\n                        (click)=\"removeSelectedFile()\">\r\n                  <i class=\"fas fa-times me-1\"></i>\r\n                  Quitar Archivo\r\n                </button>\r\n              </div>\r\n            </div>\r\n\r\n            <!-- Botones de acción -->\r\n            <div class=\"d-flex gap-2\">\r\n              <button class=\"btn btn-primary\" \r\n                      (click)=\"uploadFirma()\" \r\n                      [disabled]=\"!selectedFile || isUploading\">\r\n                <i class=\"fas fa-upload me-1\" *ngIf=\"!isUploading\"></i>\r\n                <i class=\"fas fa-spinner fa-spin me-1\" *ngIf=\"isUploading\"></i>\r\n                {{ isUploading ? 'Subiendo...' : (currentUser?.firma ? 'Actualizar Firma' : 'Subir Firma') }}\r\n              </button>\r\n            </div>\r\n          </div>\r\n\r\n          <!-- Información adicional -->\r\n          <div class=\"alert alert-light\">\r\n            <h6><i class=\"fas fa-lightbulb me-2\"></i>Información Importante</h6>\r\n            <ul class=\"mb-0\">\r\n              <li>La firma debe ser una imagen clara y legible</li>\r\n              <li>Se recomienda usar fondo transparente o blanco</li>\r\n              <li>La firma se utilizará al generar pdf de la historia clínica</li>\r\n              <li>Puede actualizar su firma en cualquier momento</li>\r\n            </ul>\r\n          </div>\r\n\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</div>\r\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../environments/environment';\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class FirmaService {\r\n  private apiUrl = `${environment.apiUrl}`;\r\n\r\n  constructor(private http: HttpClient) { }\r\n\r\n  uploadFirma(file: File): Observable<any> {\r\n    const formData = new FormData();\r\n    formData.append('firma', file);\r\n    \r\n    return this.http.post(`${this.apiUrl}/optica/firma`, formData);\r\n  }\r\n\r\n  deleteFirma(): Observable<any> {\r\n    return this.http.delete(`${this.apiUrl}/optica/firma`);\r\n  }\r\n\r\n  getFirmaUrl(firmaPath: string): string {\r\n    if (!firmaPath) return '';\r\n    return `${this.apiUrl}/uploads/${firmaPath}`;\r\n  }\r\n}\r\n"],"names":["CommonModule","FormsModule","i0","ɵɵelement","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵlistener","FirmaComponent_div_9_Template_button_click_6_listener","ɵɵrestoreView","_r1","ctx_r1","ɵɵnextContext","ɵɵresetView","deleteFirma","ɵɵtemplate","FirmaComponent_div_9_i_7_Template","FirmaComponent_div_9_i_8_Template","ɵɵadvance","ɵɵproperty","getFirmaUrl","ɵɵsanitizeUrl","isDeleting","ɵɵtextInterpolate1","FirmaComponent_div_20_Template_button_click_6_listener","_r3","removeSelectedFile","filePreview","FirmaComponent","constructor","firmaService","authService","toastService","currentUser","selectedFile","isUploading","ngOnInit","currentUser$","subscribe","user","onFileSelected","event","file","target","files","allowedTypes","includes","type","showError","size","reader","FileReader","onload","e","result","readAsDataURL","fileInput","document","getElementById","value","uploadFirma","next","response","showSuccess","firma","data","updateCurrentUser","error","console","message","confirm","undefined","ɵɵdirectiveInject","i1","FirmaService","i2","AuthService","i3","ToastService","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","FirmaComponent_Template","rf","ctx","FirmaComponent_div_9_Template","FirmaComponent_div_10_Template","FirmaComponent_Template_input_change_17_listener","$event","FirmaComponent_div_20_Template","FirmaComponent_Template_button_click_22_listener","FirmaComponent_i_23_Template","FirmaComponent_i_24_Template","ɵɵtextInterpolate","i4","NgIf","styles","environment","http","apiUrl","formData","FormData","append","post","delete","firmaPath","ɵɵinject","HttpClient","factory","ɵfac","providedIn"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}