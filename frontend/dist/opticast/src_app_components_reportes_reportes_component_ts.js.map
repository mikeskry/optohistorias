{"version":3,"file":"src_app_components_reportes_reportes_component_ts.js","mappings":"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","sources":["./src/app/components/reportes/reportes.component.ts","./src/app/services/reportes.service.ts"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { ReactiveFormsModule, FormBuilder, FormGroup, Validators } from '@angular/forms';\nimport { ReportesService } from 'src/app/services/reportes.service';\nimport { AdminService } from '../../services/admin.service';\nimport { ToastService } from '../../services/toast.service';\nimport { AuthService } from '../../services/auth.service';\nimport { Optica } from '../../models/optica.model';\n\n@Component({\n  selector: 'app-reportes',\n  standalone: true,\n  imports: [CommonModule, ReactiveFormsModule],\n  template: `\n    <div class=\"container mt-4\">\n      <!-- Formulario de filtros -->\n      <div class=\"row justify-content-center\">\n        <div class=\"col-md-8\">\n          <div class=\"card shadow-sm\">\n            <div class=\"card-header bg-primary text-white\">\n              <h5 class=\"mb-0\">\n                <i class=\"fas fa-filter me-2\"></i>\n                Reportes de Historias Clínicas\n              </h5>\n            </div>\n            <div class=\"card-body\">\n              <form [formGroup]=\"reporteForm\" (ngSubmit)=\"generarReporte()\">\n                <div class=\"row\">\n                  <!-- Selector de Óptica (Solo para Administradores) -->\n                  <div class=\"col-md-6 mb-3\" *ngIf=\"isAdmin\">\n                    <label class=\"form-label\">Óptica <span class=\"text-danger\">*</span></label>\n                    <select class=\"form-select\" formControlName=\"optica_id\" \n                            [class.is-invalid]=\"reporteForm.get('optica_id')?.invalid && reporteForm.get('optica_id')?.touched\">\n                      <option value=\"\">Seleccionar óptica...</option>\n                      <option *ngFor=\"let optica of opticas\" [value]=\"optica.id\">\n                        {{ optica.nombre }}\n                      </option>\n                    </select>\n                    <div class=\"invalid-feedback\" *ngIf=\"reporteForm.get('optica_id')?.invalid && reporteForm.get('optica_id')?.touched\">\n                      Debe seleccionar una óptica\n                    </div>\n                  </div>\n\n                  <!-- Fecha Inicial -->\n                  <div class=\"col-md-6 mb-3\" [class.col-md-6]=\"!isAdmin\" [class.col-md-3]=\"isAdmin\">\n                    <label class=\"form-label\">Fecha Inicial <span class=\"text-danger\">*</span></label>\n                    <input type=\"date\" class=\"form-control\" formControlName=\"fecha_inicial\"\n                           [class.is-invalid]=\"reporteForm.get('fecha_inicial')?.invalid && reporteForm.get('fecha_inicial')?.touched\">\n                    <div class=\"invalid-feedback\" *ngIf=\"reporteForm.get('fecha_inicial')?.invalid && reporteForm.get('fecha_inicial')?.touched\">\n                      Fecha inicial es requerida\n                    </div>\n                  </div>\n\n                  <!-- Fecha Final -->\n                  <div class=\"col-md-6 mb-3\" [class.col-md-6]=\"!isAdmin\" [class.col-md-3]=\"isAdmin\">\n                    <label class=\"form-label\">Fecha Final <span class=\"text-danger\">*</span></label>\n                    <input type=\"date\" class=\"form-control\" formControlName=\"fecha_final\"\n                           [class.is-invalid]=\"reporteForm.get('fecha_final')?.invalid && reporteForm.get('fecha_final')?.touched\">\n                    <div class=\"invalid-feedback\" *ngIf=\"reporteForm.get('fecha_final')?.invalid && reporteForm.get('fecha_final')?.touched\">\n                      Fecha final es requerida\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Información del rango -->\n                <div class=\"row\" *ngIf=\"reporteForm.get('fecha_inicial')?.value && reporteForm.get('fecha_final')?.value\">\n                  <div class=\"col-12\">\n                    <div class=\"alert alert-info\">\n                      <i class=\"fas fa-info-circle me-2\"></i>\n                      <strong>Rango seleccionado:</strong> \n                      Desde {{ reporteForm.get('fecha_inicial')?.value | date:'dd/MM/yyyy' }} \n                      hasta {{ reporteForm.get('fecha_final')?.value | date:'dd/MM/yyyy' }}\n                      <span *ngIf=\"isAdmin && reporteForm.get('optica_id')?.value\">\n                        para la óptica: {{ getOpticaNombre() }}\n                      </span>\n                    </div>\n                  </div>\n                </div>\n\n                <!-- Botones de acción -->\n                <div class=\"row\">\n                  <div class=\"col-12\">\n                    <div class=\"d-flex gap-2\">\n                      <button type=\"submit\" class=\"btn btn-primary\" [disabled]=\"reporteForm.invalid || loading\">\n                        <span *ngIf=\"loading\" class=\"spinner-border spinner-border-sm me-2\"></span>\n                        <i class=\"fas fa-file-excel me-2\" *ngIf=\"!loading\"></i>\n                        {{ loading ? 'Generando...' : 'Generar Reporte' }}\n                      </button>\n                      <button type=\"button\" class=\"btn btn-secondary\" (click)=\"limpiarFormulario()\">\n                        <i class=\"fas fa-eraser me-2\"></i>\n                        Limpiar\n                      </button>\n                      <button type=\"button\" class=\"btn btn-outline-info\" (click)=\"establecerRangoUltimos30Dias()\">\n                        <i class=\"fas fa-calendar-week me-2\"></i>\n                        Últimos 30 días\n                      </button>\n                    </div>\n                  </div>\n                </div>\n              </form>\n            </div>\n          </div>\n        </div>\n      </div>\n\n    </div>\n  `,\n  styles: [`\n    .report-icon {\n      opacity: 0.7;\n    }\n\n    .card {\n      border: none;\n      box-shadow: 0 2px 10px rgba(0,0,0,0.1);\n      border-radius: 10px;\n    }\n\n    .card-header {\n      border-radius: 10px 10px 0 0 !important;\n    }\n\n    .form-control, .form-select {\n      border-radius: 8px;\n      border: 2px solid #e9ecef;\n      transition: all 0.3s ease;\n    }\n\n    .form-control:focus, .form-select:focus {\n      border-color: var(--primary-color);\n      box-shadow: 0 0 0 0.2rem rgba(0, 123, 255, 0.25);\n    }\n\n    .btn {\n      border-radius: 8px;\n      padding: 10px 20px;\n      font-weight: 500;\n      transition: all 0.3s ease;\n    }\n\n    .btn:hover {\n      transform: translateY(-2px);\n      box-shadow: 0 4px 8px rgba(0,0,0,0.15);\n    }\n\n    .alert {\n      border-radius: 8px;\n      border: none;\n    }\n\n    .list-unstyled li {\n      padding: 5px 0;\n      font-size: 0.95rem;\n    }\n\n    .spinner-border-sm {\n      width: 1rem;\n      height: 1rem;\n    }\n\n    @media (max-width: 768px) {\n      .d-flex.gap-2 {\n        flex-direction: column;\n      }\n      \n      .btn {\n        margin-bottom: 10px;\n      }\n    }\n  `]\n})\nexport class ReportesComponent implements OnInit {\n  reporteForm: FormGroup;\n  opticas: Optica[] = [];\n  isAdmin = false;\n  loading = false;\n\n  constructor(\n    private fb: FormBuilder,\n    private reportesService: ReportesService,\n    private adminService: AdminService,\n    private toastService: ToastService,\n    private authService: AuthService\n  ) {\n    this.reporteForm = this.fb.group({\n      optica_id: [''],\n      fecha_inicial: ['', [Validators.required]],\n      fecha_final: ['', [Validators.required]]\n    });\n  }\n\n  ngOnInit(): void {\n    this.isAdmin = this.authService.isAdmin();\n    \n    if (this.isAdmin) {\n      this.reporteForm.get('optica_id')?.setValidators([Validators.required]);\n      this.cargarOpticas();\n    } else {\n      // Para usuarios de óptica, establecer su óptica automáticamente\n      const currentUser = this.authService.getCurrentUser();\n      if (currentUser?.optica_id) {\n        this.reporteForm.patchValue({ optica_id: currentUser.optica_id });\n      }\n    }\n\n    // Validación de fechas\n    this.reporteForm.get('fecha_final')?.valueChanges.subscribe(() => {\n      this.validarFechas();\n    });\n\n    this.reporteForm.get('fecha_inicial')?.valueChanges.subscribe(() => {\n      this.validarFechas();\n    });\n  }\n\n  cargarOpticas(): void {\n    this.adminService.getOpticas().subscribe({\n      next: (response) => {\n        if (response.success && response.data) {\n          this.opticas = response.data.filter(optica => optica.activo);\n        }\n      },\n      error: (error) => {\n        console.error('Error cargando ópticas:', error);\n      }\n    });\n  }\n\n  validarFechas(): void {\n    const fechaInicial = this.reporteForm.get('fecha_inicial')?.value;\n    const fechaFinal = this.reporteForm.get('fecha_final')?.value;\n\n    if (fechaInicial && fechaFinal) {\n      if (new Date(fechaInicial) > new Date(fechaFinal)) {\n        this.reporteForm.get('fecha_final')?.setErrors({ fechaInvalida: true });\n      } else {\n        this.reporteForm.get('fecha_final')?.setErrors(null);\n      }\n    }\n  }\n\n  generarReporte(): void {\n    if (this.reporteForm.valid) {\n      this.loading = true;\n      \n      const formData = this.reporteForm.value;\n      \n      this.reportesService.generarReporteExcel(formData).subscribe({\n        next: (response) => {\n          this.loading = false;\n          this.toastService.showSuccess('Reporte generado exitosamente');\n          \n          // Determinar tipo de archivo basado en el Content-Type de la respuesta\n          const contentType = response.headers?.get('content-type') || '';\n          const isExcel = contentType.includes('spreadsheetml');\n          \n          // Crear enlace de descarga\n          const blob = new Blob([response.body], { \n            type: isExcel ? 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet' : 'text/csv;charset=utf-8'\n          });\n          const url = window.URL.createObjectURL(blob);\n          const link = document.createElement('a');\n          link.href = url;\n          \n          // Nombre del archivo con fecha\n          const fechaInicial = formData.fecha_inicial;\n          const fechaFinal = formData.fecha_final;\n          const nombreOptica = this.isAdmin ? this.getOpticaNombre() : 'Mi-Optica';\n          const extension = isExcel ? 'xlsx' : 'csv';\n          link.download = `Reporte_Historias_Clinicas_${nombreOptica}_${fechaInicial}_a_${fechaFinal}.${extension}`;\n          \n          // Descargar archivo\n          document.body.appendChild(link);\n          link.click();\n          document.body.removeChild(link);\n          window.URL.revokeObjectURL(url);\n        },\n        error: (error) => {\n          this.loading = false;\n          this.toastService.showError('Error al generar el reporte');\n          console.error('Error generando reporte:', error);\n        }\n      });\n    } else {\n      this.toastService.showError('Por favor complete todos los campos requeridos');\n    }\n  }\n\n  getOpticaNombre(): string {\n    const opticaId = this.reporteForm.get('optica_id')?.value;\n    const optica = this.opticas.find(o => o.id === opticaId);\n    return optica ? optica.nombre : '';\n  }\n\n  limpiarFormulario(): void {\n    this.reporteForm.reset();\n    if (!this.isAdmin) {\n      const currentUser = this.authService.getCurrentUser();\n      if (currentUser?.optica_id) {\n        this.reporteForm.patchValue({ optica_id: currentUser.optica_id });\n      }\n    }\n  }\n\n  establecerRangoUltimos30Dias(): void {\n    const fechaFinal = new Date();\n    const fechaInicial = new Date();\n    fechaInicial.setDate(fechaFinal.getDate() - 30);\n\n    this.reporteForm.patchValue({\n      fecha_inicial: fechaInicial.toISOString().split('T')[0],\n      fecha_final: fechaFinal.toISOString().split('T')[0]\n    });\n  }\n}\n","import { Injectable } from '@angular/core';\r\nimport { HttpClient, HttpParams } from '@angular/common/http';\r\nimport { Observable } from 'rxjs';\r\nimport { environment } from '../../environments/environment';\r\n\r\nexport interface ReporteRequest {\r\n  optica_id?: number;\r\n  fecha_inicial: string;\r\n  fecha_final: string;\r\n}\r\n\r\n@Injectable({\r\n  providedIn: 'root'\r\n})\r\nexport class ReportesService {\r\n  private apiUrl = environment.apiUrl;\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  generarReporteExcel(request: ReporteRequest): Observable<any> {\r\n    let params = new HttpParams()\r\n      .set('fecha_inicial', request.fecha_inicial)\r\n      .set('fecha_final', request.fecha_final);\r\n\r\n    if (request.optica_id) {\r\n      params = params.set('optica_id', request.optica_id.toString());\r\n    }\r\n\r\n    return this.http.get(`${this.apiUrl}/reportes/historias-clinicas/excel`, {\r\n      params: params,\r\n      responseType: 'blob',\r\n      observe: 'response'\r\n    });\r\n  }\r\n\r\n  obtenerEstadisticasReporte(request: ReporteRequest): Observable<any> {\r\n    let params = new HttpParams()\r\n      .set('fecha_inicial', request.fecha_inicial)\r\n      .set('fecha_final', request.fecha_final);\r\n\r\n    if (request.optica_id) {\r\n      params = params.set('optica_id', request.optica_id.toString());\r\n    }\r\n\r\n    return this.http.get(`${this.apiUrl}/reportes/historias-clinicas/estadisticas`, {\r\n      params: params\r\n    });\r\n  }\r\n}\r\n"],"names":["CommonModule","ReactiveFormsModule","Validators","i0","ɵɵelementStart","ɵɵtext","ɵɵelementEnd","ɵɵproperty","optica_r1","id","ɵɵadvance","ɵɵtextInterpolate1","nombre","ɵɵtemplate","ReportesComponent_div_11_option_8_Template","ReportesComponent_div_11_div_9_Template","ɵɵclassProp","tmp_1_0","ctx_r1","reporteForm","get","invalid","touched","opticas","tmp_3_0","getOpticaNombre","ɵɵelement","ReportesComponent_div_26_span_9_Template","ɵɵtextInterpolate2","ɵɵpipeBind2","value","isAdmin","tmp_2_0","ReportesComponent","constructor","fb","reportesService","adminService","toastService","authService","loading","group","optica_id","fecha_inicial","required","fecha_final","ngOnInit","setValidators","cargarOpticas","currentUser","getCurrentUser","patchValue","valueChanges","subscribe","validarFechas","getOpticas","next","response","success","data","filter","optica","activo","error","console","fechaInicial","fechaFinal","Date","setErrors","fechaInvalida","generarReporte","valid","formData","generarReporteExcel","showSuccess","contentType","headers","isExcel","includes","blob","Blob","body","type","url","window","URL","createObjectURL","link","document","createElement","href","nombreOptica","extension","download","appendChild","click","removeChild","revokeObjectURL","showError","opticaId","find","o","limpiarFormulario","reset","establecerRangoUltimos30Dias","setDate","getDate","toISOString","split","ɵɵdirectiveInject","i1","FormBuilder","i2","ReportesService","i3","AdminService","i4","ToastService","i5","AuthService","selectors","standalone","features","ɵɵStandaloneFeature","decls","vars","consts","template","ReportesComponent_Template","rf","ctx","ɵɵlistener","ReportesComponent_Template_form_ngSubmit_9_listener","ReportesComponent_div_11_Template","ReportesComponent_div_18_Template","ReportesComponent_div_25_Template","ReportesComponent_div_26_Template","ReportesComponent_span_31_Template","ReportesComponent_i_32_Template","ReportesComponent_Template_button_click_34_listener","ReportesComponent_Template_button_click_37_listener","tmp_4_0","tmp_5_0","tmp_8_0","tmp_9_0","tmp_10_0","i6","NgForOf","NgIf","DatePipe","ɵNgNoValidate","NgSelectOption","ɵNgSelectMultipleOption","DefaultValueAccessor","SelectControlValueAccessor","NgControlStatus","NgControlStatusGroup","FormGroupDirective","FormControlName","styles","HttpParams","environment","http","apiUrl","request","params","set","toString","responseType","observe","obtenerEstadisticasReporte","ɵɵinject","HttpClient","factory","ɵfac","providedIn"],"sourceRoot":"webpack:///","x_google_ignoreList":[]}